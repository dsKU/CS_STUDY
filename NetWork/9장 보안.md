# 9장 보안
## 9.1 보안의 개념과 정의
### 1. 정보보안에서 보안
> 정보가 사용되는 모든 과정(수집, 가공,저장,검색,송/수신) 중에서 정보의 훼손 변조 유출을 방지하기 위한 행위들
> 기밀성 : 권한이 없는 사용자가 이용 혹은 노출되지 않도록 관리하는 것. (암호) (스누핑 스니핑 트래픽분석)
> 무결성 : 송/수신된 정보의 내용이 불법적으로 생성 또는 변경, 삭제되지 않도록 제어하는 것.(해쉬) (변조, 가장, 재전송, 부인)
> 가용성 : 정당한 사용자가 자원을 필요할 때 지체없이 접근하여 사용할 수 있어야함 (DDos)
> 네트워크는 + 서버/클라의 인증

### 2. 네트워크에서의 보안
> 네트워크 보안은 무단 액세스로부터 네트워크를 보호하는 것으로 HW/SW기술 모두 포함됨.
> 네트워크에서의 보안은 아래의 3가지 단계로 구성됨
> + 보호 : 시스템과 네트워크의 설정은 올바르게
> + 탐지 : 설정이 변경되거나 네트워크 트래픽 문제가 발생하면 이를 파악가능해야함
> + 대응 : 문제 파악 후, 가능하면 빠르고 안전하게 문제를 해결

## 9.2 보안 솔루션의 종류
1. 방화벽
2. 웹방화벽
  + SQL Injection
  + XSS
  + 정보 유출 방지, 부정 로그인 방지, 웹사이트 위번조 방지
3. NAC ( Network Access Control : 네트워크 접근 제어)
  + 네트워크에 접속하는 내부 PI의 MAC주소를 IP관리 시스템에 등록한 후 일관된 보안 관리 기능을 제공하는 보안 솔루션
  + 불법 SW 설치 방지, 백신 or 보안 패치, 비인가 시스템 자동 검출
4. UTM ( Unified Threat Management : 통합 보안 시스템 )
  + 각종 보안 장비를 한 번에!
5. WIPS ( Wireless Intrusion Prevention System : 무선 침임 방지 시스템 )

<details>
    <summary>다양한 웹공격</summary>
    <div markdown="1">       
<strong> 스푸핑</strong><br>
    ARP(MAC은 인증이 존재하지 않아 공격자가 자신의 MAC을 뿌리면 받은 사람들은 테이블을 업데이트함) - MAC주소를 STATIC으로 지정해서 운영<br>
    IP : 라우터 내의 패킷 필터링(내부사용자에 의한 경우는 방어 X), SSH등 인증 절차를 포함한 프로그램 사용<br>
    DNS : DNS쿼리에 대해 가장먼저 수신된 DNS response를 사용함. 원래의 DNS서버보다 공격자가 먼저 응답해서 위장서버로 갈 수 있게 함.<br>
    WEB, EMAIL 등 다양함<br>
    인증 기능을 가지고 있는 시스템에 침입하기 위해 해커가 사용하는 시스템을 원래의 호스트로 위장<br>
      </div><div markdown="2"> <br>
<strong>IP 하이재킹 </strong><br>
   TCP의 취약점인 리다이렉션을 이용<br>
   쌍방향 호스트 사이에 중간에 끼어듬<br>
  </div><div markdown="3"> <br>
<strong> 패킷 스니핑</strong><br>
   스니퍼 = 네트워크 패킷을 가로채는 프로그램<br>
   도청<br>
  </div><div markdown="4"> <br>
<strong> Dos</strong><br>
   TCP/IP의 구조의 취약점을 이용한 공격<br>
   서비스 거부 공격 -> 네트워크에 과다한 데이터를 보내서 서비스를 이용하게 하지 못함<br>
   SYNC 플러딩, UDP 플러딩, ICMP(핑) 플러딩, 메일공격<br>
https://www.youtube.com/watch?v=SFxId_mIGBA
    </div><<br>
  
  APT 공격 :  https://brunch.co.kr/@ka3211/23
    </details>

## 9.3 방화벽
> 침입차단시스템으로 외부망에서 내부망을 보호하는 하드웨어 or 소프트웨어
> 가장 1차적인 보안 기술
> 

1. 방화벽 기능
  + 접근 통제
  + 사용자 인증
  + 감사 및 로그
  + 프록시
  + NAT
2. 방화벽 종류
  + 패킷 필터링
  + 앱 게이트웨이
  + 서킷 게이트웨이
  + Hybrid

## 9.4 IPS, IDS
### IDS( Intrusion Detection System : 침입 탐지 시스템)
+ 시스템에 대한 인가 되지 않은 행위와 비정상적인 행동을 탐지
+ 패킷 및 세션 분석, 서명, 프로토콜 이상, 시그니처 및 이상징후, 비정상 행위 및 비정상 트래픽 탐지
> 1. 데이터 수집
> 2. 데이터 가공 및 축약
>   + 수집된 감사 대상 데이터를 침입 판정이 가능하도록 의미있는 정보로 전환/가공
>   + 데이터의 교화적인 검출과 축약
> 3. 침입 분석 및 탐지
>   + 가공된 데이터를 분석해 침입 판단 여부를 판단
> 4. 관리자에게 통보
> 
1. IDS 구성요소
  + 센서 : 보안 이벤트를 발생
  + 콘솔 : 이벤트를 모니터하고 센서를 제어하거나 경계
  + 엔진 : 센서에 의해 기록된 이벤트를 DB에 기록, 시스템 규칙을 사용하며 수신된 보안 이벤트로부터 경고  
  + 
2. 데이터 소스 기준 IDS 시스템 분류
  + 호스트 기반 ( HIDS )
    + 각 호스트 내에서의 운영 체제 감사 자료와 시스템 로그 등을 통해 침입탐지를 하는 시스템
    + 감시 대상이 되는 서버에 각각 설치
    + 스위치 환경과는 상관없음 -> 전체 네트워크에 대한 침입 탐지는 불가능
    + NIDS가 탐지 불가능한 침입을 탐지 가능/ 다른 IDS에 비해 비용 많음
  + 네트워크 기반 ( NIDS )
    + 별도의 감지기 설치 필요 -> 네트워크 도메인 세그먼트 당 하나의 감지기 설치
    + promiscuous로 동작하는 NIC를 통해 네트워크 패킷을 캡처 후, 분석을 통한 침입 탐지를 하는 시스템
    + 보통 스위치에서 업 링크된 포트에 미러링을 구성하는 방식을 사용 -> 네트워크 전반의 감시가능
    + 암호화된 내용은 삼시 불가
    
3. 침입 탐지 판정 원리에 따른 분류
  + 오용 탐지
    + 정해진 공격 모델과 일치하는경우 침입으로 간주, 지식 기반 침입 탐지
  + 비정상 행위
    + 정해진 모델을 벗어나는 경우 침임으로 간주, 행위 기반 침입 탐지  
    
* 허니팟
  + 실제 자료를 가진 호스트인 것처럼 공격자를 유인하여 공격 관련 정보를 수집/분석하기 위한 시스템 

### IPS ( Intrusion Prevention System : 침입방지 시스템 )
+ IDS + 공격 탐지 + 방지하는 장비 => 능동형 보안 솔루션
+ 일반적으로 방화벽보다 높은 수준의 성능이 필요해 방화벽 다음에 설치
![image](https://user-images.githubusercontent.com/54886969/160958307-fde118bb-06de-44cd-9345-da58a43ab895.png)

2. 종류
  + 공격 패턴 인지 방식에 의한 분류
    + Signature based IPS(지식 기반)
      + 각 공격에 대하여 정확한 Signature를 정의하고 해당 공격에 매칭된 것만 차단
      + 알려지지 않은 공격은 차단이 불가능하나 오탐이 적음
    + Heuristics based IPS(행위 기반)
      + Anomaly Detection/Prevention 방식이라고도 함
      + 알려지지 않은 공격을 수집해 오탐을 줄이고 능동적으로 대처
  + Snort based IPS(룰 기반)
    +  내가 정한 룰대로 탐지하는 솔루션.
    +  헤더와 옵션을 나눌 수 있고 패킷의 데이터 영역까지 검사함으로 방화벽과 차별화
    +  룰 헤더 : 송수신 방향으로 주어진 룰 헤더, 룰 옵션 : 공격 방식을 검사하는 값, IDS/IPS는 문자열 패턴 검사로 패킷의 데이터 검사
3. 한계
  + 패킷이 흘러가는 상황을 모니터링해 공격을 탐지 -> IPS장비를 쉽게 우회가능함.
  + IPS는 오탐이 많이 발생함으로 초반에 환경에 맞게 튜닝작업을 오래해줘야 하고 별도의 관제 인력이 장비를 모니터링하고 최적화 작업을 지속적으로 해야함
  + 그래서 나온게 NGIPS
4. 

## 9.5 DDoS 방어 장비
## 9.6 VPN
> 공중 네트워크를 전용회선처럼 사용할 수 있게 해주는 기술이나 네트워크
 1. 특징
  + 터널링
    + 상용망상에서 전용망과 같운 보안효과를 주기 위한 기법으로 VPN 내의 두 호스트 간에 가상경로를 설정해 주어 사용자에게 투명한 통신서비스를 제공 또한 터널링되는 데이터를 페이로드라고 하며 터널링 구간에서 터널링 프로토콜을 통해 페이로드는 캡슐화되어 전송
    + 터널링을 지원하는 프로토콜 
      + 2계층 : PPTP, L2TP, L2F
      + 3계층 : IPsec 
  + 암호화 및 인증
    + VPN에서는 기밀성 제공을 위해 대칭키암호를 사용하고 대칭키는 공개키 암호를 통한 키교환 뒤 공유
    + 메세지 인증은 MAC 또는 해쉬를 통해 무결성 보장
  + 접근제어
    + 필터링은 세밀하게 접근제어를 결정할 수 있지만 암호화하지 않은 IP 패킷 정보에서만 필터링 수행이 가능
    + 암호화된 패킷은 적용 불가능
  + 데이터의 기밀성, 무결성, 인증, 접근통제를 제공함
 2. IPsec VPN
   ![image](https://user-images.githubusercontent.com/54886969/161000139-81c0b432-25b5-40b0-8f1c-7db94687ae95.png)
    + IPsec VPN은 AH(Authentication Header)와 ESP(Encapsulation Security Payload)를 통해 IP 데이터그램의 인증과 무결성 기밀성을 제공
      + IPsec의 헤더
        + AH : 데이터와 순서번호 보유 송신자를 확인하고 메세지가 송신되는 동안 수정되지 않았음을 보장하는 헤더로 암호화X
        + ESP : IP페이로드를 암호화해 데이터의 기밀성 제공. 제 3자에게 데이터가 노출되는 것을 차단.
    + IPsec의 두 가지모드
      + 전송모드 : IP 페이로드를 암호화해 IP헤더로 캡슐화. 호스트간 데이터 보호가 필요할 때 사용
      + 터널모드 : IP 패킷을 모두 암호화해서 전송. 기존의 IP헤더를 볼 수 없기 때문에 새로운 IP헤더가 추가됨(보통 라우터가 추가해줌). 
    + VPN을 사용하려면 센터와 지점 모두 지원하는 장비가 있어야함.
 3. SSL VPN
  + 장소나 단말의 종류와 관계없이 내부 네트워크에 접속할 수 있는 원격 액세스 VPN.
  + 웹 브라우저와 서버 간의 통신에서 정보를 암호화. HTTPS에 사용되는 SSL이 맞습니다
  + 인증, 암호화, 메세지, 인증기능 제공하며 TCP와 응용 계층에서 노는 친구
    + Proxy방식
      + SSL VPN이 프록시 서버 역할을 하며 클라와 서버를 중계
      + 로그인 처리시간(터널링 생성시간)이 빠르고 Gate방식보다 빠르고 다운로드 속도 빠름
    + 터널 방식
      + 클라에게 가상 IP를 할당해줌
      + 로그인 처리시간 느림
      + 가상 IP를 줘야함으로 해당 대역의 고정 라우팅이 필요
    + 동작원리 ( 실제로 구현되는 순서는 TCP handshake기반으로 동작)
      + 서버 인증
      + 클라 인증
      + 연결 생성
  + 바이러스에 감염된 클라이언트가 이용시 내부 자원 점염 발생 가능성이 존재함.

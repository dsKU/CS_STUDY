# 12장 로드밸런서
## 12.1 부하분산이란?
> 둘 이상의 중앙처리장치 혹은 기억장치와 같은 컴퓨터 자원들에게 작업을 나누는 것을 의미함.<br>
> 이로써 가용성 및 응답시간의 최적화가 가능함

## 12.2 부하분산 방법
> DNS 라운드로빈 : 우리가 잘 알고있는 그것.<br>
> OS 타입 : OS가 자체적으로 가지고 있는 부하분산 기술을 이용. 큰 규묘의 네트워크에서 비효율적<br>
> 어플라이언스 타입 : 부하분산 장치 현질. 비용이 많이 들지만, 효율적인 부하 분산 + 암복호화도 있어 대규모 네트워크에서 사용

## 12.3 헬스 체크
> 니가 생각하는 그것. 패킷 보내는 거. 그리고 페일오버를 방지하기 위해 로드밸런서에 부하가 가더라도 주기를 짧게 해야함
>  + L3 : ICMP를 이용해 서버의 IP주소가 통신 가능한지 확인
>  + L4 : TCP는 3-way-handshake를 기반으로 통신. 각 포트상태를 체크.
>  + L7 : 실제 웹페이지에 통신을 시도하여 가능한지 확인

## 12.4 부하분산 알고리즘
> Round Robin : 들어오는 순서대로 차례대로 할당<br>
> Least Connection : 사용자와 서버가 정상적인 연결을 맺으면 Connection을 생성하고 로드밸런서 또한 이 정보를 가지고 있고, connection을 기반으로 부하가 가장 덜한 서버에게 요청을 전달<br>
> Ratio : 서버의 처리 능력을 고려하여 할당될 수 있는 Connection의 비율을 미리 정해둬 할당<br>
> Fastest : 응답 속도가 가장 빠른 서버에게 우선적으로 할당<br>
> Hash : 특정 클라이언트(IP)는 특정 서버로만 할당시키는 방식. 경로가 보장되며 접속자 수가 많을 수록 분산 및 효율이 뛰어남.

## 12.5 로드밸런서 종류
> 로드밸런서는 상위로 갈 수록 섬세한 로드밸런싱이 가능하나 비용이 많이 듬
### 1. L4 
> L4 계층에서 동작하는 로드밸런서로 네트워크(IP)나 트랜스포트 계층(TCP/UDP) 정보를 바탕으로 동작
> IP주소, 포트, MAC, 전송 프로토콜 등에 따라 분산처리 가능. CLB(Connection LB), SLB(Session LB)라고도 부름
>  + 여기서 사용되는 부하분산은 12.4를 참고

### 2. L7
> L7은 앱계층에서 동작. HTTP 헤더, 쿠기 등과 같은 사용자의 요청을 기준으로 분산.<br>
> L4 + 패킷의 내용을 확인해 특정 서버에 분배하는 것이 가능함.
>  + 이것으로 인해 특정한 패턴을 지닌 바이러스나 DDoS와 같은 비정상적인 트래픽 필터링 가능함 -> 서비스의 안정성 UP!UP!
>  + 캐싱 기능 제공
> but
>  + 패킷의 내용을 복호화해야해서 비쌈
>  + 클라가 로드밸런서와 인증서를 공유해야 해 보안 위험성이 존재
> 방식
>  + URL 스위칭 : ex) url/user, url/board
>  + Context 스위칭 : 클라가 요청한 특정 리소스에 대해 특정 서버에 접근 ( ex: 이미지 서버, DB서버 등)
>  + 쿠키 지속성 : 쿠키 정볼르 바탕으로 클라이언트가 연결했을 떄 동일한 서버로 계속 할당



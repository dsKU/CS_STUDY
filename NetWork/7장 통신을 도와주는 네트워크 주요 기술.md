# 7장 통신을 도와주는 네트워크 주요 기술

## 7.1 NAT/PAT
### 7.1 NAT(Network Address Translation : 네트워크 주소 변환)
### 7.1 PAT(Port Address Translation : 포트 주소 변환) 
+ NAT은 사설IP <-> 공인 IP의 변환, IPv6 <-> IPv4 변환, AFT(Address Family Translation) 등.
+ 가장 많이 사용되는 경우는 사설IP -> 공인 IP
### 7.1.1 사용되는 곳?
  + IPv4의 주소 고갈 문제 ( classless, 서브넷)
  + 보안의 강화
    + ![image](https://user-images.githubusercontent.com/54886969/159718689-79d84575-905c-4810-85f8-cc2252be71a2.png)
    + 외부와의 통신을 할 때 NAT(방화벽)을 통해서 내부 IP를 다른 IP로 변환해 통신하여 내부 IP주소 체계를 숨길 수 있음.
  + IP주소가 같은 두 네트워크 간 통신이 가능함.
    + 원래라면 IP주소 체계가 같으면 접근이 안되지만 NAT을 이용하게 되면 내부 네트워크에서 외부로 나갈 때 다른 IP로 변환되어 통신하기 때문에 중복해서 사용가능.
  + 불필요한 설정을 줄임

+ but...
  + IP가 변환되면 장애가 발생했을 때 문제해결이 힘듦.
  + 앱 개발을 하면서 더 많은 고려사항 
    <details>
    <summary>홀 펀칭</summary>
    <div markdown="1">       



    </div>
    </details>
### 7.1.2 동작 방식과 사용법
+ ![image](https://user-images.githubusercontent.com/54886969/159721855-6008a20e-11cc-46b7-b9bc-ef4472367c5b.png)
  1. 사용자는 웹서버에게 출발지 IP와 도착지 IP PORT를 담은 패킷을 전송  (1)
  2. NAT은 사용자가 보낸 패킷을 받은 뒤, 외부와 통신가능한 11.11.11.11로 주소를 변환하고 NAT테이블에 저장  (2)
  3. 패킷을 수신한 웹서버는 다시 받은 IP로 전송  (3-4)
  4. 다시 수신받은 NAT은 NAT테이블에 저장한 IP와 비교해서 내부IP로 변환 (4-6)
  + PAT도 같은 방식으로 동작함
  + 동일한 IP라도 포트를 통해서 사용자를 구분가능
  + 동시 이용자가 매우 많을 경우 POLL로 구성해야함.
  + <details>
    <summary>풀(poll)</summary>
    <div markdown="1">       

    동시 사용자가 매우 많을 때는 PAT에서 사용하는 공인 IP 주소를 IP 하나가 아닌 풀(Pool)로 구성

    </div>
    </details>
### 7.1.4 SNAT과 DNAT
  + SNAT(Source NAT) - 출발지 주소를 변경하는 NAT
    -> 내부 네트워크에서 NAT을 거쳐 외부로 가는경우 (사설에서 공인)
    -> 보안, 로드밸런서
  + DNAT(Destination NAT) - 도착지 주소를 변경하는 NAT
    -> 외부 네트워크에서 NAT를 거쳐 내부 네트워크로 접속하는 경우 (공인에서 사설)
    -> 로드밸런서로 많이 사용됨.
    -> 대외망과의 네트워크 구성에도 사용함.
+ 7.1.5 동적 NAT과 정적NAT
  + ![image](https://user-images.githubusercontent.com/54886969/159821291-6d096000-4013-424c-a7ba-08eafc044539.png)

## 7.2 DNS (Domain Name System)
### 7.2.1과 7.2.2는 생략
### 7.2.3 DNS 동작방식
    <details>
    <summary>MSA</summary>
    <div markdown="1">       

    몰?루
    
    </div>
    </details>
## 7.3 GSLB (Global Server/Service Load Balancing)
+ DNS만 사용해서 IP로드밸런싱을 할 경우 정상적인 서비스의 경우 잘 동작하지만 하나의 서버가 장애가 발생했을 때 DNS서버는 이것을 감지하지 못해 해당 서비스에 접근하지 못 함.
+ 즉, DNS 서버에서는 각 레코드에 대한 서비스 체크가 이루어지지 않고 설정된 값에 따라 동작하므로 서비스 가용성 향상 방법으로는 부적합
+ 이러한 문제를 GSLB가 도메인을 이용한 로드밸런싱 구현을 도와줌
  + 등록된 도메인에 연결된 서비스가 정상적인지 헬스 체크를 해서 정상 레코드에 대해서만 사용함
### 7.3.1 동작방식
+ ![image](https://user-images.githubusercontent.com/54886969/159834898-1f653413-9129-400b-b177-f572e4eeed30.png)
## 7.4 DHCP
https://thebook.io/007046/ch07/02/03-03/
